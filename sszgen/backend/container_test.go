package backend

import (
	"go/format"

	"github.com/OffchainLabs/methodical-ssz/sszgen/types"
)

func normalizeFixtureBytes(raw []byte) (string, error) {
	goFormatted, err := format.Source(raw)
	if err != nil {
		return string(raw), err
	}
	actual := string(goFormatted)
	if actual[len(actual)-1:] != "\n" {
		actual = actual + "\n"
	}
	return actual, nil
}

func normalizeFixtureString(raw string) (string, error) {
	return normalizeFixtureBytes([]byte(raw))
}

var testFixBeaconState types.ValRep = &types.ValueContainer{Name: "BeaconState", Package: "github.com/prysmaticlabs/prysm/v3/proto/beacon/p2p/v1", Contents: []types.ContainerField{{Key: "GenesisTime", Value: &types.ValueUint{Name: "uint64", Size: 64}}, {Key: "GenesisValidatorsRoot", Value: &types.ValueVector{Size: 32, ElementValue: &types.ValueByte{Name: "byte"}}}, {Key: "Slot", Value: &types.ValueOverlay{Name: "Slot", Package: "github.com/prysmaticlabs/eth2-types", Underlying: &types.ValueUint{Name: "uint64", Size: 64}}}, {Key: "Fork", Value: &types.ValuePointer{Referent: &types.ValueContainer{Name: "Fork", Package: "github.com/prysmaticlabs/prysm/v3/proto/beacon/p2p/v1", Contents: []types.ContainerField{{Key: "PreviousVersion", Value: &types.ValueVector{Size: 4, ElementValue: &types.ValueByte{Name: "byte"}}}, {Key: "CurrentVersion", Value: &types.ValueVector{Size: 4, ElementValue: &types.ValueByte{Name: "byte"}}}, {Key: "Epoch", Value: &types.ValueOverlay{Name: "Epoch", Package: "github.com/prysmaticlabs/eth2-types", Underlying: &types.ValueUint{Name: "uint64", Size: 64}}}}}}}, {Key: "LatestBlockHeader", Value: &types.ValuePointer{Referent: &types.ValueContainer{Name: "BeaconBlockHeader", Package: "github.com/prysmaticlabs/prysm/v3/proto/eth/v1alpha1", Contents: []types.ContainerField{{Key: "Slot", Value: &types.ValueOverlay{Name: "Slot", Package: "github.com/prysmaticlabs/eth2-types", Underlying: &types.ValueUint{Name: "uint64", Size: 64}}}, {Key: "ProposerIndex", Value: &types.ValueOverlay{Name: "ValidatorIndex", Package: "github.com/prysmaticlabs/eth2-types", Underlying: &types.ValueUint{Name: "uint64", Size: 64}}}, {Key: "ParentRoot", Value: &types.ValueVector{Size: 32, ElementValue: &types.ValueByte{Name: "byte"}}}, {Key: "StateRoot", Value: &types.ValueVector{Size: 32, ElementValue: &types.ValueByte{Name: "byte"}}}, {Key: "BodyRoot", Value: &types.ValueVector{Size: 32, ElementValue: &types.ValueByte{Name: "byte"}}}}}}}, {Key: "BlockRoots", Value: &types.ValueVector{Size: 8192, ElementValue: &types.ValueVector{Size: 32, ElementValue: &types.ValueByte{Name: "byte"}}}}, {Key: "StateRoots", Value: &types.ValueVector{Size: 8192, ElementValue: &types.ValueVector{Size: 32, ElementValue: &types.ValueByte{Name: "byte"}}}}, {Key: "HistoricalRoots", Value: &types.ValueList{MaxSize: 16777216, ElementValue: &types.ValueVector{Size: 32, ElementValue: &types.ValueByte{Name: "byte"}}}}, {Key: "Eth1Data", Value: &types.ValuePointer{Referent: &types.ValueContainer{Name: "Eth1Data", Package: "github.com/prysmaticlabs/prysm/v3/proto/eth/v1alpha1", Contents: []types.ContainerField{{Key: "DepositRoot", Value: &types.ValueVector{Size: 32, ElementValue: &types.ValueByte{Name: "byte"}}}, {Key: "DepositCount", Value: &types.ValueUint{Name: "uint64", Size: 64}}, {Key: "BlockHash", Value: &types.ValueVector{Size: 32, ElementValue: &types.ValueByte{Name: "byte"}}}}}}}, {Key: "Eth1DataVotes", Value: &types.ValueList{MaxSize: 2048, ElementValue: &types.ValuePointer{Referent: &types.ValueContainer{Name: "Eth1Data", Package: "github.com/prysmaticlabs/prysm/v3/proto/eth/v1alpha1", Contents: []types.ContainerField{{Key: "DepositRoot", Value: &types.ValueVector{Size: 32, ElementValue: &types.ValueByte{Name: "byte"}}}, {Key: "DepositCount", Value: &types.ValueUint{Name: "uint64", Size: 64}}, {Key: "BlockHash", Value: &types.ValueVector{Size: 32, ElementValue: &types.ValueByte{Name: "byte"}}}}}}}}, {Key: "Eth1DepositIndex", Value: &types.ValueUint{Name: "uint64", Size: 64}}, {Key: "Validators", Value: &types.ValueList{MaxSize: 1099511627776, ElementValue: &types.ValuePointer{Referent: &types.ValueContainer{Name: "Validator", Package: "github.com/prysmaticlabs/prysm/v3/proto/eth/v1alpha1", Contents: []types.ContainerField{{Key: "PublicKey", Value: &types.ValueVector{Size: 48, ElementValue: &types.ValueByte{Name: "byte"}}}, {Key: "WithdrawalCredentials", Value: &types.ValueVector{Size: 32, ElementValue: &types.ValueByte{Name: "byte"}}}, {Key: "EffectiveBalance", Value: &types.ValueUint{Name: "uint64", Size: 64}}, {Key: "Slashed", Value: &types.ValueBool{Name: "bool"}}, {Key: "ActivationEligibilityEpoch", Value: &types.ValueOverlay{Name: "Epoch", Package: "github.com/prysmaticlabs/eth2-types", Underlying: &types.ValueUint{Name: "uint64", Size: 64}}}, {Key: "ActivationEpoch", Value: &types.ValueOverlay{Name: "Epoch", Package: "github.com/prysmaticlabs/eth2-types", Underlying: &types.ValueUint{Name: "uint64", Size: 64}}}, {Key: "ExitEpoch", Value: &types.ValueOverlay{Name: "Epoch", Package: "github.com/prysmaticlabs/eth2-types", Underlying: &types.ValueUint{Name: "uint64", Size: 64}}}, {Key: "WithdrawableEpoch", Value: &types.ValueOverlay{Name: "Epoch", Package: "github.com/prysmaticlabs/eth2-types", Underlying: &types.ValueUint{Name: "uint64", Size: 64}}}}}}}}, {Key: "Balances", Value: &types.ValueList{MaxSize: 1099511627776, ElementValue: &types.ValueUint{Name: "uint64", Size: 64}}}, {Key: "RandaoMixes", Value: &types.ValueVector{Size: 65536, ElementValue: &types.ValueVector{Size: 32, ElementValue: &types.ValueByte{Name: "byte"}}}}, {Key: "Slashings", Value: &types.ValueVector{Size: 8192, ElementValue: &types.ValueUint{Name: "uint64", Size: 64}}}, {Key: "PreviousEpochAttestations", Value: &types.ValueList{MaxSize: 4096, ElementValue: &types.ValuePointer{Referent: &types.ValueContainer{Name: "PendingAttestation", Package: "github.com/prysmaticlabs/prysm/v3/proto/beacon/p2p/v1", Contents: []types.ContainerField{{Key: "AggregationBits", Value: &types.ValueOverlay{Name: "Bitlist", Package: "github.com/prysmaticlabs/go-bitfield", Underlying: &types.ValueList{MaxSize: 2048, ElementValue: &types.ValueByte{Name: "byte"}}}}, {Key: "Data", Value: &types.ValuePointer{Referent: &types.ValueContainer{Name: "AttestationData", Package: "github.com/prysmaticlabs/prysm/v3/proto/eth/v1alpha1", Contents: []types.ContainerField{{Key: "Slot", Value: &types.ValueOverlay{Name: "Slot", Package: "github.com/prysmaticlabs/eth2-types", Underlying: &types.ValueUint{Name: "uint64", Size: 64}}}, {Key: "CommitteeIndex", Value: &types.ValueOverlay{Name: "CommitteeIndex", Package: "github.com/prysmaticlabs/eth2-types", Underlying: &types.ValueUint{Name: "uint64", Size: 64}}}, {Key: "BeaconBlockRoot", Value: &types.ValueVector{Size: 32, ElementValue: &types.ValueByte{Name: "byte"}}}, {Key: "Source", Value: &types.ValuePointer{Referent: &types.ValueContainer{Name: "Checkpoint", Package: "github.com/prysmaticlabs/prysm/v3/proto/eth/v1alpha1", Contents: []types.ContainerField{{Key: "Epoch", Value: &types.ValueOverlay{Name: "Epoch", Package: "github.com/prysmaticlabs/eth2-types", Underlying: &types.ValueUint{Name: "uint64", Size: 64}}}, {Key: "Root", Value: &types.ValueVector{Size: 32, ElementValue: &types.ValueByte{Name: "byte"}}}}}}}, {Key: "Target", Value: &types.ValuePointer{Referent: &types.ValueContainer{Name: "Checkpoint", Package: "github.com/prysmaticlabs/prysm/v3/proto/eth/v1alpha1", Contents: []types.ContainerField{{Key: "Epoch", Value: &types.ValueOverlay{Name: "Epoch", Package: "github.com/prysmaticlabs/eth2-types", Underlying: &types.ValueUint{Name: "uint64", Size: 64}}}, {Key: "Root", Value: &types.ValueVector{Size: 32, ElementValue: &types.ValueByte{Name: "byte"}}}}}}}}}}}, {Key: "InclusionDelay", Value: &types.ValueOverlay{Name: "Slot", Package: "github.com/prysmaticlabs/eth2-types", Underlying: &types.ValueUint{Name: "uint64", Size: 64}}}, {Key: "ProposerIndex", Value: &types.ValueOverlay{Name: "ValidatorIndex", Package: "github.com/prysmaticlabs/eth2-types", Underlying: &types.ValueUint{Name: "uint64", Size: 64}}}}}}}}, {Key: "CurrentEpochAttestations", Value: &types.ValueList{MaxSize: 4096, ElementValue: &types.ValuePointer{Referent: &types.ValueContainer{Name: "PendingAttestation", Package: "github.com/prysmaticlabs/prysm/v3/proto/beacon/p2p/v1", Contents: []types.ContainerField{{Key: "AggregationBits", Value: &types.ValueOverlay{Name: "Bitlist", Package: "github.com/prysmaticlabs/go-bitfield", Underlying: &types.ValueList{MaxSize: 2048, ElementValue: &types.ValueByte{Name: "byte"}}}}, {Key: "Data", Value: &types.ValuePointer{Referent: &types.ValueContainer{Name: "AttestationData", Package: "github.com/prysmaticlabs/prysm/v3/proto/eth/v1alpha1", Contents: []types.ContainerField{{Key: "Slot", Value: &types.ValueOverlay{Name: "Slot", Package: "github.com/prysmaticlabs/eth2-types", Underlying: &types.ValueUint{Name: "uint64", Size: 64}}}, {Key: "CommitteeIndex", Value: &types.ValueOverlay{Name: "CommitteeIndex", Package: "github.com/prysmaticlabs/eth2-types", Underlying: &types.ValueUint{Name: "uint64", Size: 64}}}, {Key: "BeaconBlockRoot", Value: &types.ValueVector{Size: 32, ElementValue: &types.ValueByte{Name: "byte"}}}, {Key: "Source", Value: &types.ValuePointer{Referent: &types.ValueContainer{Name: "Checkpoint", Package: "github.com/prysmaticlabs/prysm/v3/proto/eth/v1alpha1", Contents: []types.ContainerField{{Key: "Epoch", Value: &types.ValueOverlay{Name: "Epoch", Package: "github.com/prysmaticlabs/eth2-types", Underlying: &types.ValueUint{Name: "uint64", Size: 64}}}, {Key: "Root", Value: &types.ValueVector{Size: 32, ElementValue: &types.ValueByte{Name: "byte"}}}}}}}, {Key: "Target", Value: &types.ValuePointer{Referent: &types.ValueContainer{Name: "Checkpoint", Package: "github.com/prysmaticlabs/prysm/v3/proto/eth/v1alpha1", Contents: []types.ContainerField{{Key: "Epoch", Value: &types.ValueOverlay{Name: "Epoch", Package: "github.com/prysmaticlabs/eth2-types", Underlying: &types.ValueUint{Name: "uint64", Size: 64}}}, {Key: "Root", Value: &types.ValueVector{Size: 32, ElementValue: &types.ValueByte{Name: "byte"}}}}}}}}}}}, {Key: "InclusionDelay", Value: &types.ValueOverlay{Name: "Slot", Package: "github.com/prysmaticlabs/eth2-types", Underlying: &types.ValueUint{Name: "uint64", Size: 64}}}, {Key: "ProposerIndex", Value: &types.ValueOverlay{Name: "ValidatorIndex", Package: "github.com/prysmaticlabs/eth2-types", Underlying: &types.ValueUint{Name: "uint64", Size: 64}}}}}}}}, {Key: "JustificationBits", Value: &types.ValueOverlay{Name: "Bitvector4", Package: "github.com/prysmaticlabs/go-bitfield", Underlying: &types.ValueVector{Size: 1, ElementValue: &types.ValueByte{Name: "byte"}}}}, {Key: "PreviousJustifiedCheckpoint", Value: &types.ValuePointer{Referent: &types.ValueContainer{Name: "Checkpoint", Package: "github.com/prysmaticlabs/prysm/v3/proto/eth/v1alpha1", Contents: []types.ContainerField{{Key: "Epoch", Value: &types.ValueOverlay{Name: "Epoch", Package: "github.com/prysmaticlabs/eth2-types", Underlying: &types.ValueUint{Name: "uint64", Size: 64}}}, {Key: "Root", Value: &types.ValueVector{Size: 32, ElementValue: &types.ValueByte{Name: "byte"}}}}}}}, {Key: "CurrentJustifiedCheckpoint", Value: &types.ValuePointer{Referent: &types.ValueContainer{Name: "Checkpoint", Package: "github.com/prysmaticlabs/prysm/v3/proto/eth/v1alpha1", Contents: []types.ContainerField{{Key: "Epoch", Value: &types.ValueOverlay{Name: "Epoch", Package: "github.com/prysmaticlabs/eth2-types", Underlying: &types.ValueUint{Name: "uint64", Size: 64}}}, {Key: "Root", Value: &types.ValueVector{Size: 32, ElementValue: &types.ValueByte{Name: "byte"}}}}}}}, {Key: "FinalizedCheckpoint", Value: &types.ValuePointer{Referent: &types.ValueContainer{Name: "Checkpoint", Package: "github.com/prysmaticlabs/prysm/v3/proto/eth/v1alpha1", Contents: []types.ContainerField{{Key: "Epoch", Value: &types.ValueOverlay{Name: "Epoch", Package: "github.com/prysmaticlabs/eth2-types", Underlying: &types.ValueUint{Name: "uint64", Size: 64}}}, {Key: "Root", Value: &types.ValueVector{Size: 32, ElementValue: &types.ValueByte{Name: "byte"}}}}}}}}}
